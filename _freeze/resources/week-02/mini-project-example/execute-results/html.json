{
  "hash": "7776e7657a32c46e5f65413008e404f5",
  "result": {
    "markdown": "---\ntitle: \"EDA example\"\ndescription: \"Data exploration of insurance redlining data\"\noutput: html_document\n---\n\n\n\n\n# Data and Problem Description\n\nInsurance redlining refers to the practice of refusing to issue insurance to certain\ntypes of people or within some geographic area. The name comes from the act of\ndrawing a red line around an area on a map. Now few would quibble with an insurance\ncompany refusing to sell a car insurance to a frequent drunk driver, but other\nforms of discrimination would be unacceptable.\n\nIn the late 1970s, the US Commission on Civil Rights examined charges by several\nChicago community organizations that insurance companies were redlining their\nneighborhoods. Because comprehensive information about individuals\nhomeowners was not available, the number of FAIR plan policies written\nand renewed in Chicago by ZIP code for the months of December 1977 through May\n1978 was recorded. The FAIR plan was offered by the city of Chicago as a default\npolicy to homeowners who had been rejected by the voluntary market. Information\non other variables that might affect insurance writing such as fire and theft rates was\nalso collected at the ZIP code level. The variables are:\n\n* `involact` new FAIR plan policies and renewals per 100 housing units,\n* `fire` fires per 100 housing units,\n* `theft` thefts per 1000 population,\n* `race` racial composition in percentage of minority,\n* `age` (of housing) percentage of housing units built before 1939,\n* `income` median family income in thousands of dollars,\n* `side` north or south side of Chicago.\n\nThe variable `involact` acts as a measure of insurance availability in the voluntary market, since most FAIR plan policyholders secure such coverage only after they have been rejected by the voluntary market. Insurance companies claim to reject insurances based on their pass losses (captured in variables `theft` and `fire`). The U.S. Commission on Civil Rights in 1979 was interested in how much `income`, `age` of housing, and in particular `race` affect insurance availability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(faraway)\ndata(chredlin, package=\"faraway\") # attaches the data from the faraway package\nstr(chredlin) # the name \"chredlin\" refers to CHicago REDLINing\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t47 obs. of  7 variables:\n $ race    : num  10 22.2 19.6 17.3 24.5 54 4.9 7.1 5.3 21.5 ...\n $ fire    : num  6.2 9.5 10.5 7.7 8.6 34.1 11 6.9 7.3 15.1 ...\n $ theft   : num  29 44 36 37 53 68 75 18 31 25 ...\n $ age     : num  60.4 76.5 73.5 66.9 81.4 52.6 42.6 78.5 90.1 89.8 ...\n $ involact: num  0 0.1 1.2 0.5 0.7 0.3 0 0 0.4 1.1 ...\n $ income  : num  11.74 9.32 9.95 10.66 9.73 ...\n $ side    : Factor w/ 2 levels \"n\",\"s\": 1 1 1 1 1 1 1 1 1 1 ...\n```\n:::\n\n```{.r .cell-code}\nhead(chredlin)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      race fire theft  age involact income side\n60626 10.0  6.2    29 60.4      0.0 11.744    n\n60640 22.2  9.5    44 76.5      0.1  9.323    n\n60613 19.6 10.5    36 73.5      1.2  9.948    n\n60657 17.3  7.7    37 66.9      0.5 10.656    n\n60614 24.5  8.6    53 81.4      0.7  9.730    n\n60610 54.0 34.1    68 52.6      0.3  8.231    n\n```\n:::\n:::\n\n\nThe first column is ZIP codes, since we only aggregated data for counties (not for individuals). This is not unreasonable here, due to the nature of redlining.\n\n# Data Exploration\n\nLet's take a look at the individual variables, e.g., using histograms\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nchredlin %>% mutate(side = as.numeric(side)) %>% pivot_longer(everything()) %>%\n  ggplot(aes(value)) + facet_wrap(~ name, scales = \"free\") + geom_histogram()\n```\n\n::: {.cell-output-display}\n![](mini-project-example_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nThe univariate distributions look quite nice for most of the variables. For example, we have a good spread in `race`, so we should be capable to asses its effect quite accurately. There are more features to be noticed:\n\n* `involact` has some concentration at 0, casting doubts on the usage of a linear model,\n* many variables seem to be skewed and transformations should be explored,\n  - e.g. using log-transform for `income` and `fire` seems like a no-brainer, also due to interpretation\n* there is an outlier visible at the right tail of `theft`, and other potential outliers.\n\nWe will not act on these observations at this point, with the exception of taking `log(income)`.\n\nNow let us explore relationships between the individual predictors and the response. The following plots show the simple regression lines with 95 % confidence bands (for the regression line). Jittering has been added to the variable `side` to avoid overplotting.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(chredlin,aes(race,involact)) + geom_point() +stat_smooth(method=\"lm\")\np2 <- ggplot(chredlin,aes(fire,involact)) + geom_point() +stat_smooth(method=\"lm\")\np3 <- ggplot(chredlin,aes(theft,involact)) + geom_point() +stat_smooth(method=\"lm\")\np4 <- ggplot(chredlin,aes(age,involact)) + geom_point() +stat_smooth(method=\"lm\")\np5 <- ggplot(chredlin,aes(income,involact)) + geom_point() +stat_smooth(method=\"lm\")\np6 <- ggplot(chredlin,aes(side,involact)) + geom_point(position = position_jitter(width = .2,height=0))\n\nlibrary(ggpubr)\nggarrange(p1,p2,p3,p4,p5,p6)\n```\n\n::: {.cell-output-display}\n![](mini-project-example_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nWithout a doubt, we see that `race` has a strong correlation with the response variable, potentially suggesting the bad practice of insurance redlining is based on race. However, we also may be observing confounding: can insurance companies claim that this is due to correlation between risks (`fire` and `thift`) and `race`?\n\n\n::: {.cell fig.dim='[6,3]'}\n\n```{.r .cell-code}\np1 <- ggplot(chredlin,aes(race,fire)) + geom_point() +stat_smooth(method=\"lm\")\np2 <- ggplot(chredlin,aes(race,theft)) + geom_point() +stat_smooth(method=\"lm\")\nggarrange(p1,p2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](mini-project-example_files/figure-html/unnamed-chunk-5-1.png){width=576}\n:::\n:::\n\n\nThere seems to be a positive relationship between `race` (percentage of minorities) and the variables `fire` and `theft`.\n",
    "supporting": [
      "mini-project-example_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}